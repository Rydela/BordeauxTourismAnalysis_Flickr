theme_set(theme_bw())
library("sf")
install.packages("sf")
# Load library
library(data.table)
library(readr)
library("ggplot2")
theme_set(theme_bw())
library("sf")
library("rnaturalearth")
install.packages("rnaturalearth")
install.packages("rnaturalearthdata")
# Load library
library(data.table)
library(readr)
library("ggplot2")
theme_set(theme_bw())
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")
summary(data_2007)
str(data_2007)
# Load library
library(data.table)
library(readr)
library("ggplot2")
library(rworldmap)
install.packages("rworldmap")
# Load library
library(data.table)
library(readr)
library("ggplot2")
library(rworldmap)
newmap <- getMap(resolution = "low")
plot(newmap, xlim = c(-20, 59), ylim = c(35, 71), asp = 1)
newmap <- getMap(resolution = "low")
plot(newmap, xlim = c(-20, 59), ylim = c(35, 71), asp = 1)
points(data_2007$longitude, data_2007$latitude, col = "red", cex = .6)
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
install.packages("ggmap")
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
map <- get_map(location = 'France', zoom = 4)
?register_google
map <- get_map(location = 'France', zoom = 4)
?register_google
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
?register_google
map <- get_map(location = 'Europe', zoom = 4)
map <- get_map(location = 'Europe', zoom = 4)
map <- get_map(location = 'Bordeaux', zoom = 4)
map <- get_map(location = 'Bordeaux', zoom = 4)
map <- get_map(location = 'Bordeaux', zoom = 4)
map
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
+   geom_point(aes(x = data_2007$longitude, y = data_2007$latitude, data = data_2007, alpha = .5)
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
+   geom_point(aes(data_2007$longitude = lon, data_2007$latitude = lat, data = data_2007, alpha = .5)
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(data_2007$longitude = lon, data_2007$latitude = lat,
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(data_2007$longitude = lon, data_2007$latitude = lat),
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
google_keys()
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
google_key()
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
google_key()
ggmap_show_api_key()
map <- get_map(location = 'Bordeaux', zoom = 4)
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
map <- get_map(location = 'Bordeaux', zoom = 4)
mapPoints <- ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
# Load library
library(data.table)
library(readr)
library(ggplot2)
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
google_key()
ggmap_show_api_key()
gc <- geocode("white house, washington dc")
map <- get_map(gc)
(bb <- attr(map, "bb"))
(bbox <- bb2bbox(bb))
map <- get_map(location = 'Bordeaux', zoom = 4)
ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
map <- get_map(location = 'Bordeaux', zoom = 15)
ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
map <- get_map(location = 'Bordeaux', zoom = 12)
ggmap(map) +
geom_point(
aes(x = data_2007$longitude, y = data_2007$latitude ),
data = data_2007, alpha = .5
)
filtered_2007 <- data_2007%>%
group_by(owner_id) %>%
filter(n()>2)
map <- get_map(location = 'Bordeaux', zoom = 12)
ggmap(map) +
geom_point(
aes(x = filtered_2007$longitude, y = filtered_2007$latitude ),
data = filtered_2007, alpha = .5
)
View(filtered_2007)
View(filtered_2007)
dbs = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
library(dbscan)
install.packages("dbscan")
library(dbscan)
dbs = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
nbClustersCom = 0;
for (i in 1:summary(dbs)[1]) {
nbClustersCom[dbs$cluster[i]] = 1
}
nbClusters = length(nbClustersCom)
SommeLatitude = rep(0,nbClusters);
SommeLongitude = rep(0,nbClusters);
FinalLatitude = rep(0,nbClusters);
FinalLongitude = rep(0,nbClusters);
nb = rep(0,nbClusters);
for (i in 1:summary(dbs)[1]) {
SommeLatitude[dbs$cluster[i]] = SommeLatitude[dbs$cluster[i]]  + Y$latitude[i]
SommeLongitude[dbs$cluster[i]] = SommeLongitude[dbs$cluster[i]] + Y$longitude[i]
nb[dbs$cluster[i]] = nb[dbs$cluster[i]] +1
}
library(dbscan)
dbs = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
nbClustersCom = 0;
for (i in 1:summary(dbs)[1]) {
nbClustersCom[dbs$cluster[i]] = 1
}
nbClusters = length(nbClustersCom)
SumLatitude = rep(0,nbClusters);
SumLongitude = rep(0,nbClusters);
FinalLatitude = rep(0,nbClusters);
FinalLongitude = rep(0,nbClusters);
nb = rep(0,nbClusters);
for (i in 1:summary(dbs)[1]) {
SumLatitude[dbs$cluster[i]] = SumLatitude[dbs$cluster[i]]  + filtered_2007$latitude[i]
SumLongitude[dbs$cluster[i]] = SumLongitude[dbs$cluster[i]] + filtered_2007$longitude[i]
nb[dbs$cluster[i]] = nb[dbs$cluster[i]] +1
}
for (i in 1:nbClusters) {
FinalLatitude[i] = SumLatitude[i] / nb[i]
FinalLongitude[i] = SumLongitude[i] / nb[i]
}
library(dbscan)
dbs_2007 = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
nbClustersCom = 0;
for (i in 1:summary(dbs)[1]) {
nbClustersCom[dbs$cluster[i]] = 1
}
nbClusters = length(nbClustersCom)
SumLatitude = rep(0,nbClusters);
SumLongitude = rep(0,nbClusters);
FinalLatitude = rep(0,nbClusters);
FinalLongitude = rep(0,nbClusters);
nb = rep(0,nbClusters);
for (i in 1:summary(dbs)[1]) {
SumLatitude[dbs$cluster[i]] = SumLatitude[dbs$cluster[i]]  + filtered_2007$latitude[i]
SumLongitude[dbs$cluster[i]] = SumLongitude[dbs$cluster[i]] + filtered_2007$longitude[i]
nb[dbs$cluster[i]] = nb[dbs$cluster[i]] +1
}
for (i in 1:nbClusters) {
FinalLatitude[i] = SumLatitude[i] / nb[i]
FinalLongitude[i] = SumLongitude[i] / nb[i]
}
summary(dbs_2007)
library(dbscan)
dbs_2007 = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
nbClustersCom = 0;
for (i in 1:summary(dbs)[1]) {
nbClustersCom[dbs$cluster[i]] = 1
}
nbClusters = length(nbClustersCom)
SumLatitude = rep(0,nbClusters);
SumLongitude = rep(0,nbClusters);
FinalLatitude = rep(0,nbClusters);
FinalLongitude = rep(0,nbClusters);
nb = rep(0,nbClusters);
for (i in 1:summary(dbs)[1]) {
SumLatitude[dbs$cluster[i]] = SumLatitude[dbs$cluster[i]]  + filtered_2007$latitude[i]
SumLongitude[dbs$cluster[i]] = SumLongitude[dbs$cluster[i]] + filtered_2007$longitude[i]
nb[dbs$cluster[i]] = nb[dbs$cluster[i]] +1
}
for (i in 1:nbClusters) {
FinalLatitude[i] = SumLatitude[i] / nb[i]
FinalLongitude[i] = SumLongitude[i] / nb[i]
}
summary(dbs_2007)
str(dbs_2007)
library(dbscan)
dbs_2007 = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80, method = "dist")
library(dbscan)
dbs_2007 = dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
nbClustersCom = 0;
for (i in 1:summary(dbs)[1]) {
nbClustersCom[dbs$cluster[i]] = 1
}
nbClusters = length(nbClustersCom)
SumLatitude = rep(0,nbClusters);
SumLongitude = rep(0,nbClusters);
FinalLatitude = rep(0,nbClusters);
FinalLongitude = rep(0,nbClusters);
nb = rep(0,nbClusters);
for (i in 1:summary(dbs)[1]) {
SumLatitude[dbs$cluster[i]] = SumLatitude[dbs$cluster[i]]  + filtered_2007$latitude[i]
SumLongitude[dbs$cluster[i]] = SumLongitude[dbs$cluster[i]] + filtered_2007$longitude[i]
nb[dbs$cluster[i]] = nb[dbs$cluster[i]] +1
}
for (i in 1:nbClusters) {
FinalLatitude[i] = SumLatitude[i] / nb[i]
FinalLongitude[i] = SumLongitude[i] / nb[i]
}
summary(dbs_2007)
str(dbs_2007)
library(dbscan)
dbs_2007_clusters <- dbscan(filtered_2007["latitude", "longitude"], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007_clusters <- dbscan(filtered_2007[4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007_clusters <- dbscan(filtered_2007[4:5], eps = 0.00055, minPts = 80))
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 = dbscan(filtered_2007[4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[ ,4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,4:5], eps = 0.00055, minPts = 80)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
summary(dbs_2007)
str(dbs_2007)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
summary(dbs_2007)
str(dbs_2007)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = long, y = lat, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3) +
coord_map() +
theme_stripped +
theme_empty +
theme(legend.position = "none")
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = long, y = lat, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3) +
coord_map() +
summary(dbs_2007)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = long, y = lat, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3) +
coord_map())
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = long, y = lat, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = filtered_2007$longitude, y = filtered_2007$latitude) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = filtered_2007$longitude, y = filtered_2007$latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
map <- get_map(location = 'Bordeaux', zoom = 12)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.00055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.0000055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.0055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
View(data_2007)
View(data_2007)
data = rbind(data_2007,data_2008)
View(data)
install.packages('skimr')
skimr::skim(data_2007)
## User must appear more than once
filtered_2007 <-
data_2007%>%
group_by(owner_id) %>%
filter(n()>2)%>%
arrange(owner_id,date_taken)
View(filtered_2007)
# Load libraries
library(rworldmap)
library(ggmap)
register_google(key = "AIzaSyA5RyFB0KqjBQZ2o-uOUcGYK8jjb4v9eYM")
google_key()
ggmap_show_api_key()
# Map Bordeaux
map <- get_map(location = 'Bordeaux', zoom = 15)
# Plot data points
ggmap(map) +
geom_point(
aes(x = filtered_2007$longitude, y = filtered_2007$latitude),
data = filtered_2007, alpha = .5
)
groups  <- filtered_2007 %>% filter(cluster != 0)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.0055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
library(dbscan)
dbs_2007 <- dbscan(filtered_2007[,3:4], eps = 0.000055, minPts = 80)
filtered_2007$cluster <- dbs_2007$cluster
summary(dbs_2007)
str(dbs_2007)
groups  <- filtered_2007 %>% filter(cluster != 0)
noise  <- filtered_2007 %>% filter(cluster == 0)
ggplot(filtered_2007, aes(x = longitude, y = latitude, alpha = 0.5)) +
geom_point(aes(fill = "grey"), noise) +
geom_point(aes(colour = as.factor(cluster)), groups,
size = 3)
knitr::opts_chunk$set(echo = TRUE)
## User must appear more than once
filtered_2007 <- data_2007%>%
group_by(owner_id) %>%
filter(n()>2)%>%
arrange(owner_id,date_taken)
